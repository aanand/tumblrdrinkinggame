!!!

%html
  %head
    %title Tumblr Drinking Game
    %meta{ :name => "viewport", :content => "width = device-width" }
    %link{ :rel => 'stylesheet', :href => 'stylesheet.css' }
    %script{ :type => 'text/javascript', :src => '//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery.min.js' }
    %script{ :type => 'text/javascript', :src => '//cdnjs.cloudflare.com/ajax/libs/knockout/2.1.0/knockout-min.js' }
    %script{ :type => 'text/javascript', :src => 'application.js' }

  %body
    #container
      #game
        %h1 Tumblr Drinking Game

        %form{ 'data-bind' => 'submit: checkNoun' }
          %label
            ~ "fuckyeah"
            %input#noun{ :type => 'text', :value => 'bats' }>
            ~ ".tumblr.com"

          %button{ :type => 'submit' } Check

        #message{ 'data-bind' => 'visible: (status !== "initial"), attr: { class: lastResult() && lastResult().cssClass }' }
          %span{ 'data-bind' => 'if: (status() === "checking")' } Checking...

          %span{ 'data-bind' => 'if: (status() === "checked")' }
            %span{ 'data-bind' => 'if: lastResult().exists' }
              %a{ 'data-bind' => 'text: lastResult().domain, attr: { href: "http://" + lastResult().domain }', target: '_blank' }
              exists.

            %span{ 'data-bind' => 'if: !lastResult().exists' }
              %span{ 'data-bind' => 'text: lastResult().domain' }
              does not exist.

            %span{ 'data-bind' => 'if: shouldDrink()' }
              Drink!

            %span{ 'data-bind' => 'if: !shouldDrink()' }
              Do not drink.

        #history{ 'data-bind' => 'visible: history().length > 0' }
          %h2 Turn history

          %ul
            / ko foreach: history
            %li{ 'data-bind' => 'text: noun, attr: { class: cssClass }' }
            / /ko

        #new-game{ 'data-bind' => 'visible: history().length > 0' }
          %h2
            New game:
            %a#must-exist{ 'href' => '#', 'data-bind' => 'click: function() { newGame(true) }' } optimistic
            %a#must-not-exist{ 'href' => '#', 'data-bind' => 'click: function() { newGame(false) }' } pessimistic

      #credits
        Made by
        %a{ :href => 'http://aanandprasad.com' } Aanand Prasad

    %script{ :type => 'text/javascript' }
      :plain
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-16551991-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

